<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>BookLoot - Achieve Your Productivity Goals</title>

    <!-- Tailwind config must be defined BEFORE the tailwind CDN so custom colors are available -->
    <script>
        tailwind = window.tailwind || {};
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-bg': '#FFFFFF', /* Clean White Background */
                        'text-dark': '#111111', /* Charcoal Black Text */
                        'accent-gold': {
                            DEFAULT: '#F5C542', /* Gold Primary */
                            dark: '#E0A52B',
                            light: '#FFD46A',
                        },
                        'neutral-gray': '#F3F4F6', /* Light Gray for sections */
                    },
                    boxShadow: {
                        'gold-xl': '0 12px 30px -8px rgba(245,197,66,0.25)',
                    },
                    borderRadius: {
                        '3xl': '1.5rem',
                    }
                }
            }
        };
    </script>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="icon" href="https://placehold.co/32x32/F5C542/111111?text=BL">

    <!-- Custom CSS for visuals (no tailwind.config in here) -->
    <style>
        /* Inter Font fallback */
        body { font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; }

        /* Gold Gradient for the Headline */
        .gold-text {
            background-image: linear-gradient(90deg, #E0A52B 0%, #F5C542 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Hero Background with Subtle Geometric Texture */
        .bg-textured-hero {
            background-color: #f8f8f8;
            background-image:
                radial-gradient(#d1d5db 0.5px, transparent 0.5px),
                radial-gradient(#d1d5db 0.5px, #f8f8f8 0.5px);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
        }

        /* Custom scroll-in animation utility */
        .fade-in-up {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s cubic-bezier(0.19, 1, 0.22, 1), transform 0.8s cubic-bezier(0.19, 1, 0.22, 1);
        }
        .is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* CTA button - minor non-tailwind specifics (kept small) */
        .cta-btn {
            background-color: #F5C542;
            color: #111111;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.06);
        }
        .cta-btn:hover {
            background-color: #E0A52B;
            box-shadow: 0 10px 15px -3px rgba(245,197,66,0.3), 0 4px 6px -4px rgba(245,197,66,0.3);
            transform: translateY(-1px);
        }
        .cta-btn:active {
            background-color: #F5C542;
            box-shadow: none;
            transform: translateY(0);
        }

        input:focus {
            outline: none;
            border-color: #F5C542 !important;
            box-shadow: 0 0 0 3px rgba(245,197,66,0.18);
        }

        /* Mobile timeline dots */
        .mobile-timeline .step::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.5rem;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #F5C542;
            border: 2px solid #FFFFFF;
            box-shadow: 0 0 0 1px #F5C542;
            transition: all 0.3s ease;
        }
        .mobile-timeline .step:not(:last-child)::after {
            content: '';
            position: absolute;
            left: 5px;
            top: 1.5rem;
            height: calc(100% - 1.5rem);
            width: 2px;
            background-color: #D1D5DB;
        }
    </style>
</head>

<body class="bg-primary-bg text-text-dark min-h-screen antialiased">

    <!-- Status Banner for Mobile Success Message (Hidden by default) -->
    <div id="status-banner" class="fixed bottom-0 left-0 w-full p-4 text-center text-sm transition-transform duration-300 transform translate-y-full z-50 shadow-2xl">
        <!-- Message will be inserted here -->
    </div>

    <!-- Header / Sticky Nav - Clean White Look -->
    <header class="sticky top-0 z-40 bg-primary-bg/95 backdrop-blur-sm shadow-md p-3 border-b border-neutral-gray">
        <div class="container mx-auto flex justify-between items-center px-4">
            <!-- Logo -->
            <a href="#hero" class="flex items-center text-2xl font-black tracking-tight text-text-dark">
                <!-- Placeholder Logo 'BL' -->
                <img src="Capture.PNG" alt="BookLoot Logo" class="w-8 h-8 mr-2 object-contain rounded-lg">
                <span>BookLoot</span>
            </a>

            <nav class="space-x-6 text-sm font-medium hidden sm:block">
                <a href="#features" class="hover:text-accent-gold transition">Features</a>
                <a href="#perks" class="hover:text-accent-gold transition">Perks</a>
                <a href="#how-it-works" class="hover:text-accent-gold transition">Timeline</a>
            </nav>
        </div>
    </header>

    <main class="overflow-x-hidden">

        <!-- 1. Hero Section -->
        <section id="hero" class="bg-textured-hero py-20 sm:py-32 relative overflow-hidden flex items-center justify-center text-center px-4">
            <div class="relative z-10 w-full max-w-lg fade-in-up">
                <div class="p-8 sm:p-10 bg-white shadow-2xl border border-gray-100 rounded-3xl
                             transform skew-y-1 sm:skew-y-2 translate-y-2 transition duration-500 ease-out
                             hover:skew-y-0 hover:translate-y-0 hover:shadow-2xl">
                    <div class="transform -skew-y-1 sm:-skew-y-2 transition duration-500 ease-out hover:skew-y-0 text-center">
                        <p class="text-sm font-semibold text-accent-gold uppercase tracking-wider mb-3">The Future of Focused Work</p>
                        <h1 class="text-4xl sm:text-6xl font-extrabold tracking-tighter leading-tight text-text-dark">
                            Loot Your Time Back.
                        </h1>
                        <p class="mt-4 mb-8 text-lg text-text-dark/70 max-w-md mx-auto">
                            BookLoot combines deep work sessions with gamified rewards, turning your to-do list into a quest.
                        </p>

                        <!-- Waitlist Form (Supabase Integration) -->
                        <form id="waitlist-form" class="mt-8 mx-auto max-w-sm">
                            <div class="flex flex-col space-y-4">
                                <input
                                    type="text"
                                    name="name"
                                    required
                                    placeholder="Your Name"
                                    class="w-full px-5 py-3.5 text-lg rounded-xl bg-white border border-gray-300 text-text-dark placeholder-gray-500 focus:ring-accent-gold focus:border-accent-gold shadow-inner transition"
                                />
                                <input
                                    type="email"
                                    name="email"
                                    required
                                    placeholder="Your best email address"
                                    class="w-full px-5 py-3.5 text-lg rounded-xl bg-white border border-gray-300 text-text-dark placeholder-gray-500 focus:ring-accent-gold focus:border-accent-gold shadow-inner transition"
                                />
                                <button
                                    type="submit"
                                    class="cta-btn w-full px-8 py-4 text-xl font-bold rounded-xl transition duration-300"
                                >
                                    Join Waitlist
                                </button>
                            </div>
                        </form>

                        <!-- Waitlist Counter -->
                        <div class="mt-6 text-sm font-medium text-text-dark/60">
                            <p id="waitlist-counter">
                                <span class="animate-pulse">Loading waitlist count...</span>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 3. Exclusive Offers (Perks) -->
        <section id="perks" class="py-16 sm:py-24 bg-primary-bg px-4">
            <div class="container mx-auto">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-center mb-10 fade-in-up">
                    <span class="text-accent-gold">Exclusive</span> Waitlist Perks
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl mx-auto">
                    <!-- Perk Card 1 -->
                    <div class="p-6 rounded-2xl bg-white shadow-xl transition transform hover:-translate-y-1 duration-300 border-t-4 border-accent-gold fade-in-up">
                        <span class="text-3xl mb-3 block text-accent-gold">üî•</span>
                        <h3 class="text-xl font-semibold text-text-dark mb-2">50% Off Launch</h3>
                        <p class="text-text-dark/70 text-sm">Get half off your first month when BookLoot goes live.</p>
                    </div>

                    <!-- Perk Card 2 -->
                    <div class="p-6 rounded-2xl bg-white shadow-xl transition transform hover:-translate-y-1 duration-300 border-t-4 border-gray-300 fade-in-up" style="transition-delay: 0.1s;">
                        <span class="text-3xl mb-3 block text-gray-500">üöÄ</span>
                        <h3 class="text-xl font-semibold text-text-dark mb-2">Early Access</h3>
                        <p class="text-text-dark/70 text-sm">Be one of the first 1,000 users to test the beta version.</p>
                    </div>

                    <!-- Perk Card 3 -->
                    <div class="p-6 rounded-2xl bg-white shadow-xl transition transform hover:-translate-y-1 duration-300 border-t-4 border-accent-gold/70 fade-in-up" style="transition-delay: 0.2s;">
                        <span class="text-3xl mb-3 block text-accent-gold/70">üó≥Ô∏è</span>
                        <h3 class="text-xl font-semibold text-text-dark mb-2">Priority Feature Voting</h3>
                        <p class="text-text-dark/70 text-sm">Directly influence our roadmap and vote on upcoming features.</p>
                    </div>

                    <!-- Perk Card 4 -->
                    <div class="p-6 rounded-2xl bg-white shadow-xl transition transform hover:-translate-y-1 duration-300 border-t-4 border-accent-gold-dark fade-in-up" style="transition-delay: 0.3s;">
                        <span class="text-3xl mb-3 block text-accent-gold-dark">üì¶</span>
                        <h3 class="text-xl font-semibold text-text-dark mb-2">Monthly Loot Box Giveaway</h3>
                        <p class="text-text-dark/70 text-sm">Entry into a monthly draw for gift cards and exclusive app items.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Discord CTA -->
        <section id="discord-cta" class="py-12 bg-neutral-gray px-4 border-t border-b border-gray-200">
            <div class="container mx-auto max-w-2xl text-center rounded-xl p-8 bg-white shadow-xl fade-in-up">
                <h2 class="text-2xl font-extrabold text-text-dark mb-4">Join the Community Quest</h2>
                <p class="text-text-dark/70 mb-6">
                    Hop into our official Discord server to chat with the team, share ideas, and find accountability partners.
                </p>
                <a href="https://discord.gg/GPHNbDWg" target="_blank"
                    class="inline-flex items-center justify-center px-8 py-3 text-lg font-bold rounded-xl bg-[#7289DA] text-white hover:bg-[#677BC4] transition duration-300 shadow-lg"
                >
                    <!-- Discord Icon -->
                    <svg class="w-6 h-6 mr-3" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.78 2.05L17.52 0H6.48L4.22 2.05A.6.6 0 004 2.4v18.2a.6.6 0 00.22.34l2.26 2.05h11.04l2.26-2.05a.6.6 0 00.22-.34V2.4a.6.6 0 00-.22-.35zM8.33 16.48c-1.39 0-2.52-1.14-2.52-2.54s1.13-2.54 2.52-2.54 2.52 1.14 2.52 2.54-1.13 2.54-2.52 2.54zm7.34 0c-1.39 0-2.52-1.14-2.52-2.54s1.13-2.54 2.52-2.54 2.52 1.14 2.52 2.54-1.13 2.54-2.52 2.54z"/>
                    </svg>
                    Join Discord Now
                </a>
            </div>
        </section>

        <!-- 4. Feature Section -->
        <section id="features" class="py-16 sm:py-24 bg-primary-bg px-4">
            <div class="container mx-auto">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-center mb-12 fade-in-up">
                    The <span class="text-text-dark/70">Core</span> BookLoot Experience
                </h2>

                <div class="grid grid-cols-2 md:grid-cols-3 gap-6 max-w-6xl mx-auto">
                    <!-- Feature Card 1 -->
                    <div class="col-span-2 sm:col-span-1 p-6 rounded-xl bg-white text-center shadow-lg transition duration-300 hover:shadow-xl hover:-translate-y-1 fade-in-up border border-gray-200">
                        <svg class="w-10 h-10 mx-auto mb-4 text-accent-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <h3 class="text-xl font-semibold text-text-dark mb-1">Deep Focus Timer</h3>
                        <p class="text-text-dark/70 text-sm">Structured sessions to eliminate distractions and boost output.</p>
                    </div>

                    <!-- Feature Card 2 -->
                    <div class="col-span-2 sm:col-span-1 p-6 rounded-xl bg-white text-center shadow-lg transition duration-300 hover:shadow-xl hover:-translate-y-1 fade-in-up" style="transition-delay: 0.1s;">
                        <svg class="w-10 h-10 mx-auto mb-4 text-accent-gold/70" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 11V9a2 2 0 00-2-2m2 4v4a2 2 0 002 2m-2-4h-4m2 2h4m2 4v4m-6 0h4m2-4v-4m-2 4h-4m2-4v-4"></path>
                        </svg>
                        <h3 class="text-xl font-semibold text-text-dark mb-1">Gamified Rewards</h3>
                        <p class="text-text-dark/70 text-sm">Earn virtual gold and items for completing tasks and staying focused.</p>
                    </div>

                    <!-- Feature Card 3 -->
                    <div class="col-span-2 sm:col-span-1 p-6 rounded-xl bg-white text-center shadow-lg transition duration-300 hover:shadow-xl hover:-translate-y-1 fade-in-up border border-gray-200" style="transition-delay: 0.2s;">
                        <svg class="w-10 h-10 mx-auto mb-4 text-accent-gold-light" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <h3 class="text-xl font-semibold text-text-dark mb-1">Task Breakdown</h3>
                        <p class="text-text-dark/70 text-sm">Break down epic projects into manageable, lootable micro-quests.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 5. How It Works Section -->
        <section id="how-it-works" class="py-16 sm:py-24 bg-neutral-gray px-4">
            <div class="container mx-auto max-w-4xl">
                <h2 class="text-3xl sm:text-4xl font-extrabold text-center mb-12 fade-in-up">
                    Your <span class="text-accent-gold">Looting</span> Journey
                </h2>

                <!-- Mobile Timeline -->
                <div class="relative mobile-timeline space-y-10 md:hidden">
                    <div class="step fade-in-up relative pl-6">
                        <h3 class="text-xl font-semibold text-text-dark">1. Define Quest</h3>
                        <p class="text-text-dark/70 text-sm">Input your task and estimate the required focus time.</p>
                    </div>

                    <div class="step fade-in-up relative pl-6" style="transition-delay: 0.1s;">
                        <h3 class="text-xl font-semibold text-text-dark">2. Enter Focus Mode</h3>
                        <p class="text-text-dark/70 text-sm">Start the deep focus timer and minimize distractions.</p>
                    </div>

                    <div class="step fade-in-up relative pl-6" style="transition-delay: 0.2s;">
                        <h3 class="text-xl font-semibold text-text-dark">3. Collect Loot</h3>
                        <p class="text-text-dark/70 text-sm">Successfully complete the session and receive your rewards.</p>
                    </div>

                    <div class="step fade-in-up relative pl-6" style="transition-delay: 0.3s;">
                        <h3 class="text-xl font-semibold text-text-dark">4. Upgrade Stats</h3>
                        <p class="text-text-dark/70 text-sm">Use your loot to unlock features, avatars, and powerful boosters.</p>
                    </div>
                </div>

                <!-- Desktop Timeline -->
                <div class="hidden md:flex justify-between items-start text-center relative pt-4">
                    <div class="absolute top-0 left-0 right-0 h-1 bg-gray-300"></div>

                    <div class="flex-1 px-4 fade-in-up">
                        <div class="w-4 h-4 rounded-full bg-accent-gold mx-auto -mt-[18px] border-2 border-neutral-gray"></div>
                        <h3 class="mt-4 text-lg font-semibold text-text-dark">1. Define Quest</h3>
                        <p class="text-text-dark/70 text-sm">Input task and time.</p>
                    </div>

                    <div class="flex-1 px-4 fade-in-up" style="transition-delay: 0.1s;">
                        <div class="w-4 h-4 rounded-full bg-accent-gold mx-auto -mt-[18px] border-2 border-neutral-gray"></div>
                        <h3 class="mt-4 text-lg font-semibold text-text-dark">2. Enter Focus Mode</h3>
                        <p class="text-text-dark/70 text-sm">Start the timer.</p>
                    </div>

                    <div class="flex-1 px-4 fade-in-up" style="transition-delay: 0.2s;">
                        <div class="w-4 h-4 rounded-full bg-accent-gold mx-auto -mt-[18px] border-2 border-neutral-gray"></div>
                        <h3 class="mt-4 text-lg font-semibold text-text-dark">3. Collect Loot</h3>
                        <p class="text-text-dark/70 text-sm">Receive rewards.</p>
                    </div>

                    <div class="flex-1 px-4 fade-in-up" style="transition-delay: 0.3s;">
                        <div class="w-4 h-4 rounded-full bg-accent-gold mx-auto -mt-[18px] border-2 border-neutral-gray"></div>
                        <h3 class="mt-4 text-lg font-semibold text-text-dark">4. Upgrade Stats</h3>
                        <p class="text-text-dark/70 text-sm">Unlock new features.</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-primary-bg p-8 border-t border-gray-200">
        <div class="container mx-auto text-center">
            <div class="flex items-center justify-center mb-2">
               <img src="Capture.PNG" alt="BookLoot Logo" class="w-8 h-8 mr-2 object-contain rounded-lg">
                <h3 class="text-2xl font-bold text-text-dark">BookLoot</h3>
            </div>

            <p class="text-xs text-text-dark/50 mb-0">¬© 2025 BookLoot. All rights reserved. Quest begins soon.</p>
        </div>
    </footer>

    <!-- Supabase CDN -->
    <script type="module">
        import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

        // Supabase configuration
        const SUPABASE_URL = 'https://lngbifzswweieuzfjrbi.supabase.co';
        // Note: The key below is public (anon) and safe to use in client-side code for read/insert operations.
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxuZ2JpZnpzd3dlaWV1emZqcmJpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzMjQ1MTEsImV4cCI6MjA3OTkwMDUxMX0.05mmRg8IqGPG4eFZHKH_RtbHvc0Bz6b9K2txpcmX-j8';
        
        // Initialize Supabase Client globally
        window.supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        const waitlistTableName = 'waitlist';


        // Utility for exponential backoff retry logic (adapted for async functions)
        async function fetchWithRetry(fn, retries = 3, delay = 1000) {
            for (let i = 0; i < retries; i++) {
                try {
                    const result = await fn();
                    return result;
                } catch (error) {
                    if (i === retries - 1) throw error;
                    console.warn(`Attempt ${i + 1} failed. Retrying in ${delay / 1000}s...`, error);
                    await new Promise(resolve => setTimeout(resolve, delay));
                    delay *= 2; // Exponential backoff
                }
            }
        }

        // Fetch and update the waitlist counter using Supabase
        async function fetchWaitlistCount() {
            const counterEl = document.getElementById('waitlist-counter');
            
            try {
                // Fetch the count from the Supabase table
                const { count, error } = await window.supabase
                    .from(waitlistTableName)
                    .select('*', { count: 'exact', head: true });

                if (error) throw error;

                const formattedCount = (count || 0).toLocaleString();
                
                counterEl.innerHTML = `<span class="text-text-dark text-3xl sm:text-4xl font-extrabold tracking-tight">${formattedCount}</span> users already joined ‚Äî don‚Äôt miss out!`;

            } catch (e) {
                console.error('Supabase Count Error:', e);
                // Fallback to static count on error
                counterEl.innerHTML = `<span class="text-text-dark text-3xl sm:text-4xl font-extrabold tracking-tight">12,345+</span> users already joined ‚Äî don‚Äôt miss out!`;
            }
        }


        // Handle form submission and email insertion using Supabase
        async function handleWaitlistSubmit(event) {
            event.preventDefault();
            const form = event.target;
            const nameInput = form.querySelector('input[name="name"]');
            const emailInput = form.querySelector('input[name="email"]');

            const name = nameInput.value.trim();
            const email = emailInput.value.trim();

            const submitBtn = form.querySelector('button[type="submit"]');

            // Client-side validation
            if (!name || !email) {
                showStatusBanner('Please enter both your name and email.', 'error');
                return;
            }

            // Check if Supabase is initialized
            if (!window.supabase) {
                showStatusBanner('System not ready. Supabase client failed to initialize.', 'error');
                console.error("Supabase client is not available.");
                return;
            }

            submitBtn.disabled = true;
            submitBtn.textContent = 'Joining...';
            submitBtn.classList.add('opacity-75');

            try {
                // Insert the new waitlist entry into the correct 'waitlist' table
                // FIX: Removed 'joined_at' field as it caused a column-not-found error, 
                // relying on Supabase table's default timestamp (e.g., 'created_at') instead.
                const { error } = await fetchWithRetry(() =>
                    window.supabase
                        .from(waitlistTableName)
                        .insert([
                            { name: name, email: email }
                        ])
                );
                
                if (error) throw error;
                
                showStatusBanner(`Success! Welcome, ${name}. You are on the BookLoot Waitlist! üéâ`, 'success');
                nameInput.value = '';
                emailInput.value = '';
                
                // Refresh the counter immediately
                fetchWaitlistCount();

            } catch (e) {
                console.error('Supabase Insert Error:', e);
                // The general error message now points the user to check console for details if needed
                showStatusBanner(`Error: Failed to join the waitlist. Check console for details.`, 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Join Waitlist';
                submitBtn.classList.remove('opacity-75');
            }
        }

        // Show mobile-style success/error banner
        function showStatusBanner(message, type = 'info') {
            const banner = document.getElementById('status-banner');
            const colorClasses = {
                success: 'bg-emerald-600 text-white',
                error: 'bg-red-600 text-white',
                info: 'bg-blue-600 text-white'
            };
            banner.className = `fixed bottom-0 left-0 w-full p-4 text-center text-sm transition-transform duration-500 transform translate-y-full z-50 shadow-2xl rounded-t-xl ${colorClasses[type] || colorClasses.info}`;
            banner.textContent = message;

            // Reveal
            requestAnimationFrame(() => {
                banner.classList.remove('translate-y-full');
            });

            // Hide after 5 seconds
            setTimeout(() => {
                banner.classList.add('translate-y-full');
            }, 5000);
        }

        // --- SCROLL ANIMATIONS (Intersection Observer) ---
        function setupScrollAnimations() {
            const elements = document.querySelectorAll('.fade-in-up');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, {
                rootMargin: '0px 0px -10% 0px',
                threshold: 0.1
            });

            elements.forEach(el => observer.observe(el));
        }
        
        /**
         * The main logic that runs after DOMContentLoaded.
         */
        function initializeAppLogic() {
            fetchWaitlistCount(); 
            
            const form = document.getElementById('waitlist-form');
            if (form) {
                // Attach listener immediately since Supabase is ready
                form.addEventListener('submit', handleWaitlistSubmit);
            }

            setupScrollAnimations();
        }

        // --- GLOBAL INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', initializeAppLogic);
    </script>
</body>
</html>